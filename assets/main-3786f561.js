import{a as b}from"./vendor-ca03c6e9.js";(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const n of document.querySelectorAll('link[rel="modulepreload"]'))i(n);new MutationObserver(n=>{for(const s of n)if(s.type==="childList")for(const r of s.addedNodes)r.tagName==="LINK"&&r.rel==="modulepreload"&&i(r)}).observe(document,{childList:!0,subtree:!0});function a(n){const s={};return n.integrity&&(s.integrity=n.integrity),n.referrerPolicy&&(s.referrerPolicy=n.referrerPolicy),n.crossOrigin==="use-credentials"?s.credentials="include":n.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function i(n){if(n.ep)return;n.ep=!0;const s=a(n);fetch(n.href,s)}})();const d=b.create({baseURL:"https://event-on-backend.onrender.com",headers:{"Content-Type":"application/json"}}),y=async(t=1,e=8)=>{try{return(await d.get(`/events?page=${t}&limit=${e}`)).data}catch(a){throw console.error("Error fetching events:",a),a}},L=(t,e,a)=>{const i=document.querySelector(".pagination");let n="";if(n+=`<button class="pagination-btn" ${t===1?"disabled":""} data-page="1">&laquo;</button>`,n+=`<button class="pagination-btn" ${t===1?"disabled":""} data-page="${t-1}">&lt;</button>`,e<=5)for(let r=1;r<=e;r++)n+=`<button class="pagination-btn ${r===t?"active":""}" data-page="${r}">${r}</button>`;else if(t<=2){for(let r=1;r<=3;r++)n+=`<button class="pagination-btn ${r===t?"active":""}" data-page="${r}">${r}</button>`;n+='<span class="pagination-dots">...</span>',n+=`<button class="pagination-btn" data-page="${e}">${e}</button>`}else if(t>e-2){n+='<button class="pagination-btn" data-page="1">1</button>',n+='<span class="pagination-dots">...</span>';for(let r=e-2;r<=e;r++)n+=`<button class="pagination-btn ${r===t?"active":""}" data-page="${r}">${r}</button>`}else{n+='<button class="pagination-btn" data-page="1">1</button>',n+='<span class="pagination-dots">...</span>';for(let r=t-1;r<=t+1;r++)n+=`<button class="pagination-btn ${r===t?"active":""}" data-page="${r}">${r}</button>`;n+='<span class="pagination-dots">...</span>',n+=`<button class="pagination-btn" data-page="${e}">${e}</button>`}n+=`<button class="pagination-btn" ${t===e?"disabled":""} data-page="${t+1}">&gt;</button>`,n+=`<button class="pagination-btn" ${t===e?"disabled":""} data-page="${e}">&raquo;</button>`,i.innerHTML=n,document.querySelectorAll(".pagination-btn").forEach(r=>{r.addEventListener("click",c=>{const l=Number(c.target.getAttribute("data-page"));l!==t&&(sessionStorage.setItem("currentPage",l),a(l))})})},E=(t,e={})=>t.filter(a=>{const i=e.title?a.title.toLowerCase().includes(e.title.toLowerCase()):!0,n=e.organizer?a.organizer.toLowerCase().includes(e.organizer.toLowerCase()):!0;let s=!0;return e.date&&(s=new Date(a.eventDate).toISOString().split("T")[0]===e.date),i&&n&&s}),$=(t,e)=>{const{fullName:a,email:i}=e;return t.filter(n=>{const s=a?n.fullName.toLowerCase().includes(a.toLowerCase()):!0,r=i?n.email.toLowerCase().includes(i.toLowerCase()):!0;return s&&r})},w=()=>({titleInput:document.querySelector("#titleFilter"),organizerInput:document.querySelector("#organizerFilter"),dateInput:document.querySelector("#dateFilter"),fullNameInput:document.getElementById("fullNameFilter"),emailInput:document.getElementById("emailFilter")}),I=(t,e)=>{t.innerHTML=e},C=(t,e)=>{t.innerHTML=e},p=(t,e)=>{t.innerHTML=e},D=t=>{t.innerHTML=""},F=(t,e)=>{t&&(t.textContent=e)},S=t=>{t.innerHTML+='<a class="back-to-link list-link" href="../index.html">back to events</a>'};let u=1,m=1,f=!1;const T=(t={},e=1)=>{g(e,t)},M=()=>{const{titleInput:t,organizerInput:e,dateInput:a}=w();if(t&&e&&a&&!f){const i=()=>{const n={title:t.value,organizer:e.value,date:a.value};T(n,u)};t.addEventListener("input",i),e.addEventListener("input",i),a.addEventListener("input",i),f=!0}else console.error("Filter input elements not found.")},g=async(t=1,e={})=>{const a=document.querySelector(".events");if(!a){console.error("Events container not found.");return}const i=sessionStorage.getItem("currentPage"),n=i?Number(i):t;try{const{events:s,totalPages:r}=await y(n);m=r;const c=E(s,e);if(c.length===0){p(a,"<p>No events available.</p>");return}const l=c.map(o=>`
      <li class="event-item">
        <div class="event-content">
          <div>
            <h3>${o.title}</h3>
            <p class="event-description">${o.description}</p>
          </div>
          <div>
            <p>Organizer: ${o.organizer}</p>
            <p>Date of the event: ${new Date(o.eventDate).toLocaleDateString()}</p>
          </div>
        </div>
        <div class="event-link-container">
          <a class="link-register" href="../registration-page.html?eventId=${o._id}">Register</a>
          <a class="link-view" href="../participants-page.html?eventId=${o._id}&title=${encodeURIComponent(o.title)}">View</a>
        </div>
      </li>
    `).join("");I(a,l),L(n,m,o=>{u=o,sessionStorage.setItem("currentPage",o),g(u,e)})}catch(s){p(a,"<p>Error loading events. Please try again later.</p>"),console.error("Error fetching events:",s)}};document.addEventListener("DOMContentLoaded",()=>{const t=setInterval(()=>{document.querySelector(".events")&&(clearInterval(t),g(),M())},100)});const q=async t=>{try{return(await d.get(`/participants/${t}`)).data||null}catch(e){if(e.response&&e.response.status===404)return[];throw e}},N=async t=>{try{return(await d.post("/participants/register",t)).data}catch(e){throw console.error("Error registering participant:",e),e}},v=t=>new URLSearchParams(window.location.search).get(t),z=t=>t.map(e=>`
    <li class="participant-item">
      <svg class="participant-icon" width="44" height="44">
        <use href="./img/icon.svg#icon-user"></use>
      </svg>
      <div>
        <h3>${e.fullName}</h3>
        <p>Email: ${e.email}</p>
      </div>
    </li>
  `).join(""),h=async(t={})=>{const e=document.querySelector(".participants-list-container"),a=document.querySelector(".participants-list"),i=document.querySelector(".event-title");if(!e||!a){console.error("Participants container or list not found.");return}const n=v("eventId"),s=v("title");if(D(a),F(i,s||"Event Participants"),!n){p(a,"<p>Event ID not provided.</p>");return}try{const r=await q(n),c=$(r,t);if(c.length===0)p(a,'<p class="message">There are no participants.</p>');else{const l=z(c);C(a,l)}S(a)}catch(r){p(a,"<p>Error loading participants. Please try again later.</p>"),console.error("Error fetching participants:",r)}},O=()=>{const{fullNameInput:t,emailInput:e}=getFilterElements();if(!t||!e){console.error("Filter input elements not found.");return}const a=()=>{const i={fullName:t.value,email:e.value};h(i)};t.addEventListener("input",a),e.addEventListener("input",a)},H=()=>{document.querySelector(".participants-list-container")&&(h(),O())};document.addEventListener("DOMContentLoaded",()=>{const t=setInterval(()=>{document.querySelector(".participants-list-container")&&(clearInterval(t),H())},100)});const P=t=>{const e=new Date(t),a=new Date;let i=a.getFullYear()-e.getFullYear();const n=a.getMonth()-e.getMonth();return(n<0||n===0&&a.getDate()<e.getDate())&&i--,i},k=()=>new URLSearchParams(window.location.search).get("eventId"),R=async t=>{t.preventDefault();const e=k();if(!e){alert("Event ID is missing!");return}const a=new FormData(t.target),i=a.get("birthday"),n=P(i);if(n<18){alert("Participants must be at least 18 years old.");return}if(n>100){alert("Participants must be younger than 100 years old.");return}const s={fullName:a.get("fullName"),email:a.get("email"),birthday:i,source:a.get("source"),eventId:e};try{const r=await N(s);console.log("Participant registered successfully:",r),alert("The participant has been successfully registered!"),t.target.reset()}catch(r){console.error("Error registering participant:",r),alert("Error while registering participant. Please try again.")}};document.addEventListener("DOMContentLoaded",()=>{const t=document.querySelector("#registrationForm");t&&t.addEventListener("submit",R)});
//# sourceMappingURL=main-3786f561.js.map
